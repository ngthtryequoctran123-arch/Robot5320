<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>RoBot.5320 | Tr·ª£ l√Ω ·∫£o & ESP32</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="RoBot.5320 - Tr·ª£ l√Ω ·∫£o ti·∫øng Vi·ªát, kho firmware ESP32, ESP32 Flash Tool, k√≠ch ho·∫°t thi·∫øt b·ªã v√† c·ªông ƒë·ªìng h·ªó tr·ª£.">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <script type="module" src="https://unpkg.com/esp-web-tools@latest/dist/web/install-button.js"></script>

  <style>
    :root {
      --bg-main:#020910;
      --bg-panel:#0f2027;
      --bg-card:#14252d;
      --accent:#1de9b6;
      --text:#e5e7eb;
      --muted:#9ca3af;
      --radius-card:20px;
      --transition:0.25s;
    }

    *{margin:0;padding:0;box-sizing:border-box;font-family:"Inter",sans-serif;}
    body{
      background:
        radial-gradient(circle at top, rgba(29,233,182,0.05), transparent 55%),
        radial-gradient(circle at top right, rgba(56,189,248,0.06), transparent 60%),
        var(--bg-main);
      color:var(--text);
      min-height:100vh;
      -webkit-font-smoothing:antialiased;
    }
    a{text-decoration:none;color:inherit;}

    /* üî• Thanh Ch·ªß Web */
    .owner {
      text-align: center;
      font-weight: 700;
      font-size: 20px;
      line-height: 1.8;
      padding: 18px 0;
      color: #1de9b6;
      letter-spacing: 1px;
      background: linear-gradient(90deg, #071b23, #0f2027, #071b23);
      border-bottom: 1px solid rgba(29, 233, 182, 0.6);
      box-shadow:
        0 0 10px rgba(29, 233, 182, 0.4),
        0 0 20px rgba(29, 233, 182, 0.3),
        inset 0 0 12px rgba(29, 233, 182, 0.25);
      text-shadow:
        0 0 5px #1de9b6,
        0 0 10px #1de9b6,
        0 0 20px #00ffc6,
        0 0 40px #00ffc6;
      animation: glowPulse 2s infinite alternate ease-in-out;
      position: sticky;
      top: 0;
      z-index: 999;
    }
    @keyframes glowPulse {
      0% {
        text-shadow:
          0 0 6px #1de9b6,
          0 0 14px #00ffc6,
          0 0 24px #00ffc6,
          0 0 40px #00ffc6;
      }
      100% {
        text-shadow:
          0 0 2px #1de9b6,
          0 0 6px #00ffc6,
          0 0 14px #00ffc6,
          0 0 24px #00ffc6;
      }
    }

    /* Trang ch√≠nh */
    .page{
      max-width:1200px;
      margin:0 auto;
      padding:32px 20px 50px;
    }

    header{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:14px;
      margin-bottom:26px;
    }
    .brand{display:flex;align-items:center;gap:10px;}
    .dot{
      width:30px;height:30px;border-radius:999px;
      background:radial-gradient(circle at 30% 0,#ffffff,var(--accent));
      box-shadow:0 0 25px rgba(29,233,182,0.9);
    }
    .title{font-weight:600;font-size:20px;}
    .sub{font-size:11px;color:var(--muted);}
    .pill{
      padding:6px 13px;
      border-radius:999px;
      border:1px solid rgba(148,163,253,0.26);
      font-size:10px;
      color:var(--accent);
      display:inline-flex;
      align-items:center;
      gap:6px;
      background:rgba(4,9,17,0.98);
      box-shadow:0 10px 26px rgba(0,0,0,0.9);
    }
    .pill span{
      width:7px;height:7px;border-radius:999px;
      background:var(--accent);
      box-shadow:0 0 12px rgba(29,233,182,1);
    }

    .panel{
      background:var(--bg-panel);
      padding:26px;
      border-radius:25px;
      box-shadow:0 24px 70px rgba(0,0,0,0.9);
      border:1px solid rgba(148,163,253,0.16);
    }

    .panel h2{
      font-size:24px;
      margin-bottom:8px;
      font-weight:600;
    }

    .panel p.subtxt{
      font-size:13px;
      color:var(--muted);
      margin-bottom:24px;
      max-width:640px;
    }

    .cards{
      display:grid;
      grid-template-columns:repeat(auto-fit,minmax(250px,1fr));
      gap:20px;
    }

    .card{
      background:linear-gradient(145deg,#14252d,#0c1a20);
      padding:22px;
      border-radius:var(--radius-card);
      border:1px solid rgba(29,233,182,0.3);
      box-shadow:0 0 20px rgba(0,0,0,0.8);
      cursor:pointer;
      transition:all var(--transition);
    }
    .card:hover{
      transform:scale(1.04);
      border-color:rgba(29,233,182,0.6);
      box-shadow:0 0 25px rgba(29,233,182,0.3);
    }
    .card h3{
      font-size:18px;
      color:var(--accent);
      margin-bottom:4px;
    }
    .card p{
      font-size:13px;
      color:var(--text);
    }

    footer{
      text-align:center;
      font-size:10px;
      color:var(--muted);
      margin-top:20px;
    }

    /* Overlay chung */
    .overlay{
      display:none;
      position:fixed;
      inset:0;
      background:radial-gradient(circle at center,rgba(10,20,25,0.97),rgba(0,0,0,0.95));
      backdrop-filter:blur(8px);
      z-index:100;
      overflow-y:auto;
    }
    .close-x{
      position:fixed;
      top:14px;
      right:18px;
      font-size:22px;
      color:#9ca3af;
      cursor:pointer;
      z-index:110;
    }
    .close-x:hover{color:#ef4444;}

    .home-link{
      display:inline-block;
      font-size:15px;
      color:#1de9b6;
      margin-bottom:14px;
      background:rgba(29,233,182,0.1);
      padding:6px 14px;
      border-radius:8px;
      border:1px solid rgba(29,233,182,0.3);
      cursor:pointer;
      transition:all 0.25s;
    }
    .home-link:hover{
      background:rgba(29,233,182,0.3);
      color:#fff;
    }

    /* Popup ƒê·∫∑t h√†ng */
    .popup{
      background:linear-gradient(180deg,#ffffff,#f8f9fa);
      color:#111827;
      border-radius:18px;
      max-width:470px;
      margin:100px auto 50px;
      padding:28px;
      box-shadow:0 0 30px rgba(29,233,182,0.4);
      border:2px solid rgba(29,233,182,0.4);
      font-size:15px;
    }
    .popup h3{
      text-align:center;
      font-size:22px;
      color:#0d9488;
      margin-bottom:5px;
    }
    .popup p{text-align:center;margin:2px 0;}
    .popup input,
    .popup select,
    .popup textarea{
      width:100%;
      margin:6px 0;
      padding:10px;
      border-radius:10px;
      border:1px solid #b0bfc7;
      font-size:14px;
    }
    .popup textarea{min-height:70px;}
    .popup .send-btn{
      background:#0d9488;
      font-weight:600;
      color:#fff;
      padding:10px 18px;
      border:none;
      border-radius:10px;
      cursor:pointer;
    }
    .popup .send-btn:hover{background:#08917a;}
    .popup .cancel-btn{
      background:#e5e7eb;
      color:#111827;
      padding:10px 18px;
      border:none;
      border-radius:10px;
      cursor:pointer;
    }
    .popup .cancel-btn:hover{background:#d1d5db;}

    /* K√≠ch ho·∫°t */
    .activate-box{
      background:linear-gradient(145deg,#0f2027,#203a43);
      color:#e5e7eb;
      border-radius:20px;
      max-width:470px;
      margin:100px auto 50px;
      padding:30px;
      box-shadow:0 0 40px rgba(29,233,182,0.4);
      border:2px solid rgba(29,233,182,0.5);
      font-size:15px;
    }
    .activate-box h2{
      font-size:22px;
      color:var(--accent);
      margin-bottom:6px;
    }
    .activate-box p{
      font-size:13px;
      color:#9ca3af;
      margin-bottom:14px;
    }
    .activate-box label{
      font-size:12px;
      color:#9ca3af;
      margin-bottom:3px;
      display:block;
    }
    .activate-box input{
      width:100%;
      padding:10px;
      margin-bottom:8px;
      border-radius:10px;
      border:1px solid rgba(148,163,253,0.4);
      background:#020910;
      color:#e5e7eb;
      font-size:14px;
    }
    .activate-box button{
      width:100%;
      padding:10px;
      border:none;
      border-radius:10px;
      background:#1de9b6;
      color:#020910;
      font-weight:600;
      font-size:15px;
      cursor:pointer;
      margin-top:4px;
      box-shadow:0 0 20px rgba(29,233,182,0.3);
    }
    .activate-box button:hover{
      background:#13b38d;
      box-shadow:0 0 25px rgba(29,233,182,0.6);
    }
    .activate-box .result{
      margin-top:8px;
      min-height:18px;
      font-size:13px;
    }

    /* Flash Tool */
    #esmart-flasher-wrap{
      max-width:900px;
      margin:60px auto 40px;
    }
    #esmart-flasher{
      font-family:"Inter",sans-serif;
      color:var(--text);
    }
    #esmart-flasher .container{
      background:var(--bg-card);
      border-radius:20px;
      padding:30px;
      border:2px solid rgba(29,233,182,0.4);
      box-shadow:0 0 40px rgba(29,233,182,0.25);
      text-align:center;
    }
    #esmart-flasher h1{
      font-size:24px;
      color:var(--accent);
      margin-bottom:6px;
      text-shadow:0 0 10px rgba(29,233,182,0.4);
    }
    #esmart-flasher p.subtitle{
      font-size:14px;
      color:var(--muted);
      margin-bottom:16px;
    }
    #esmart-flasher .select-row{
      display:flex;
      gap:16px;
      justify-content:space-between;
      flex-wrap:wrap;
      margin-bottom:12px;
    }
    #esmart-flasher .select-group{
      flex:1;
      min-width:220px;
      text-align:left;
    }
    #esmart-flasher .select-group label{
      font-size:12px;
      color:var(--accent);
      margin-bottom:4px;
      display:block;
      font-weight:600;
    }
    #esmart-flasher select{
      width:100%;
      padding:9px 10px;
      font-size:14px;
      border-radius:10px;
      border:1px solid rgba(148,163,253,0.3);
      background:#0b1520;
      color:var(--text);
      outline:none;
      transition:0.2s;
    }
    #esmart-flasher select:focus{
      border-color:var(--accent);
      box-shadow:0 0 0 2px rgba(29,233,182,0.3);
    }
    #esmart-flasher #schematic{
      margin-top:16px;
      max-width:100%;
      border-radius:14px;
      border:1px solid rgba(148,163,253,0.25);
      box-shadow:0 0 28px rgba(0,0,0,0.9);
      display:none;
      cursor:pointer;
      transition:transform 0.2s;
    }
    #esmart-flasher #schematic:hover{transform:scale(1.03);}
    #esmart-flasher esp-web-install-button{
      margin-top:18px;
      display:inline-block;
      background:var(--accent);
      color:#000;
      font-weight:600;
      border-radius:10px;
      padding:8px 16px;
      box-shadow:0 0 18px rgba(29,233,182,0.6);
    }
    #esmart-flasher #log{
      width:100%;
      height:160px;
      margin-top:18px;
      background:#020910;
      border:1px solid rgba(148,163,253,0.25);
      overflow-y:auto;
      text-align:left;
      padding:10px;
      font-family:monospace;
      font-size:12px;
      border-radius:10px;
      color:#1de9b6;
      box-sizing:border-box;
    }
    #esmart-flasher footer{
      margin-top:14px;
      font-size:11px;
      color:var(--muted);
    }

    #imageModal{
      display:none;
      position:fixed;
      z-index:9999;
      top:0;left:0;width:100%;height:100%;
      background-color:rgba(0,0,0,0.9);
      justify-content:center;
      align-items:center;
    }
    #imageModal img{
      max-width:95%;
      max-height:95%;
      border-radius:14px;
      box-shadow:0 0 40px rgba(29,233,182,0.4);
      background:#000;
    }

    @media(max-width:640px){
      header{flex-direction:column;align-items:flex-start;}
      .panel{padding:20px;}
      .card{padding:18px;}
      .popup,.activate-box{margin-top:80px;}
    }
  </style>
</head>
<body>
  <!-- Thanh Ch·ªß Web -->
  <div class="owner">
    üåê <b>Ch·ªß Web:</b> Nguy·ªÖn Tr∆∞·ªùng Qu·ªëc 2k5 <br>
    üìû <b>S·ªë ƒêT:</b> 0869635798
  </div>

  <!-- Trang ch√≠nh -->
  <div class="page">
    <header>
      <a href="https://www.tiktok.com/@robot.5320" target="_blank" class="brand">
        <div class="dot"></div>
        <div>
          <div class="title">RoBot.5320</div>
          <div class="sub">Tr·ª£ l√Ω ·∫£o & ESP32 Ecosystem</div>
        </div>
      </a>
      <div style="text-align:right;font-size:12px;color:var(--muted);">
        <div class="pill"><span></span>N·∫°p firmware ‚Ä¢ K√≠ch ho·∫°t thi·∫øt b·ªã ‚Ä¢ ƒê·∫∑t mua nhanh</div>
        <div>ESP32-S3 ‚Ä¢ Xiaozhi AI ‚Ä¢ PC Windows</div>
      </div>
    </header>

    <section class="panel">
      <h2>Trung t√¢m RoBot.5320</h2>
      <p class="subtxt">
        ƒêi·ªÅu h∆∞·ªõng h·ªá sinh th√°i RoBot5320 - Xiaozhi AI: t·∫£i firmware, n·∫°p tr·ª±c tuy·∫øn, k√≠ch ho·∫°t thi·∫øt b·ªã,
        ƒë·∫∑t mua loa AI v√† truy c·∫≠p c√°c k√™nh n·ªôi dung ch√≠nh th·ª©c.
      </p>

      <div class="cards">
        <div class="card">
          <h3>üíª Lily cho Windows</h3>
          <p>Tr·ª£ l√Ω ·∫£o ti·∫øng Vi·ªát cho PC: ƒë·ªçc vƒÉn b·∫£n, ƒëi·ªÅu khi·ªÉn, h·ªó tr·ª£ h·ªçc t·∫≠p & l√†m vi·ªác.</p>
        </div>

        <div class="card">
          <h3>üì¶ Kho Firmware ESP32</h3>
          <p>Danh s√°ch firmware ESP32/ESP32-S3 t·ªëi ∆∞u cho RoBot5320 & Xiaozhi AI.</p>
        </div>

        <div class="card" onclick="openFlash()">
          <h3>‚ö° ESP32 Flash Tool</h3>
          <p>M·ªü c√¥ng c·ª• n·∫°p firmware ESP32-S3 tr·ª±c tuy·∫øn ngay tr√™n trang n√†y.</p>
        </div>

        <div class="card" onclick="openActivate()">
          <h3>üîë K√≠ch ho·∫°t thi·∫øt b·ªã</h3>
          <p>Nh·∫≠p m√£ active ƒë·ªÉ k√≠ch ho·∫°t RoBot5320 - Xiaozhi AI v√† x√°c nh·∫≠n thi·∫øt b·ªã.</p>
        </div>

        <div class="card" onclick="openOrder()">
          <h3>üõí Mua s·∫£n ph·∫©m</h3>
          <p>ƒê·∫∑t mua RoBot5320 - Xiaozhi AI, h·ªó tr·ª£ k·ªπ thu·∫≠t, giao h√†ng to√†n qu·ªëc.</p>
        </div>

        <a class="card" href="https://www.facebook.com/quoc.nguyentruong.96930?locale=vi_VN" target="_blank">
          <h3>üìò Facebook</h3>
          <p>Theo d√µi c·∫≠p nh·∫≠t s·∫£n ph·∫©m, livestream v√† h∆∞·ªõng d·∫´n.</p>
        </a>

        <a class="card" href="https://www.tiktok.com/@robot.5320" target="_blank">
          <h3>üéµ TikTok</h3>
          <p>Video demo s·∫£n ph·∫©m, th·ª≠ nghi·ªám, m·∫πo d√πng ESP32.</p>
        </a>

        <a class="card" href="https://www.youtube.com/@Robot.5320" target="_blank">
          <h3>‚ñ∂Ô∏è YouTube</h3>
          <p>Video chi ti·∫øt l·∫Øp r√°p, c·∫•u h√¨nh, l·∫≠p tr√¨nh RoBot5320.</p>
        </a>
      </div>
    </section>

    <footer>
      ¬© 2025 RoBot.5320 ‚Äî H·ªá sinh th√°i tr·ª£ l√Ω ·∫£o & ESP32.
    </footer>
  </div>

  <!-- Overlay ƒê·∫∑t h√†ng -->
  <div id="orderOverlay" class="overlay">
    <span class="close-x" onclick="closeOrder()">‚úñ</span>
    <form class="popup" action="https://formspree.io/f/mldarbrj" method="POST">
      <div class="home-link" onclick="closeOrder()">‚¨Ö Trang Ch·ªß</div>
      <h3>üõí ƒê·∫∑t mua RoBot5320 - Xiaozhi AI</h3>
      <p>üí∞ Gi√° g·ªëc: <b style="text-decoration:line-through;color:gray;">770.000ƒë</b></p>
      <p>üè∑Ô∏è Gi√° m·ªü b√°n: <b style="color:red;font-size:18px;">398.000ƒë</b></p>
      <input type="text" name="H·ªç t√™n" placeholder="H·ªç t√™n" required>
      <input type="tel" name="S·ªë ƒëi·ªán tho·∫°i" placeholder="S·ªë ƒëi·ªán tho·∫°i" required>
      <input type="text" name="ƒê·ªãa ch·ªâ" placeholder="ƒê·ªãa ch·ªâ nh·∫≠n h√†ng" required>
      <label>Ch·ªçn phi√™n b·∫£n:</label>
      <select name="Phi√™n b·∫£n" required>
        <option>Phi√™n b·∫£n Ti√™u chu·∫©n: 398k</option>
        <option>Phi√™n b·∫£n VIP: 495k</option>
        <option>Phi√™n b·∫£n ViPro: 530k</option>
      </select>
      <textarea name="Ghi ch√∫" placeholder="Ghi ch√∫ th√™m (m√†u s·∫Øc, th·ªùi gian nh·∫≠n h√†ng...)"></textarea>
      <div style="text-align:right;margin-top:10px;">
        <button type="button" class="cancel-btn" onclick="closeOrder()">H·ªßy</button>
        <button type="submit" class="send-btn">G·ª≠i ƒë∆°n h√†ng</button>
      </div>
    </form>
  </div>

  <!-- Overlay K√≠ch ho·∫°t -->
  <div id="activateOverlay" class="overlay">
    <span class="close-x" onclick="closeActivate()">‚úñ</span>
    <div class="activate-box">
      <div class="home-link" onclick="closeActivate()">‚¨Ö Trang Ch·ªß</div>
      <h2>üîë K√≠ch ho·∫°t thi·∫øt b·ªã RoBot.5320</h2>
      <p>Nh·∫≠p M√£ thi·∫øt b·ªã &amp; M√£ k√≠ch ho·∫°t ƒë∆∞·ª£c cung c·∫•p k√®m s·∫£n ph·∫©m.</p>
      <form id="activeForm">
        <label>M√£ thi·∫øt b·ªã / Device ID</label>
        <input id="deviceID" type="text" placeholder="VD: RB5320-ESP32S3-XXXX" required>
        <label>M√£ k√≠ch ho·∫°t / Active Code</label>
        <input id="activeCode" type="text" placeholder="Nh·∫≠p m√£ k√≠ch ho·∫°t" required>
        <label>Email (t√πy ch·ªçn)</label>
        <input id="email" type="email" placeholder="Nh·∫≠p email n·∫øu mu·ªën">
        <button type="submit">K√≠ch ho·∫°t ngay</button>
      </form>
      <div id="result" class="result"></div>
    </div>
  </div>

  <!-- Overlay ESP32 Flash Tool -->
  <div id="flashOverlay" class="overlay">
    <span class="close-x" onclick="closeFlash()">‚úñ</span>
    <div id="esmart-flasher-wrap">
      <div id="esmart-flasher">
        <div class="container">
          <div class="home-link" onclick="closeFlash()">‚¨Ö Trang Ch·ªß</div>
          <h1>‚ö° ESP32 Flash Tool</h1>
          <p class="subtitle">
            Ch·ªçn ƒë√∫ng board &amp; firmware, k·∫øt n·ªëi ESP32-S3 b·∫±ng Chrome / Edge tr√™n PC, sau ƒë√≥ nh·∫•n "Connect" ƒë·ªÉ n·∫°p.
          </p>

          <div class="select-row">
            <div class="select-group">
              <label for="boardSelect">1Ô∏è‚É£ Ch·ªçn lo·∫°i board:</label>
              <select id="boardSelect">
                <option value="esp32s3">ESP32-S3</option>
                <option value="esp32s3ai">ESP32-S3(AI)</option>
                <option value="esp32s3cam">ESP32-S3-CAM</option>
              </select>
            </div>
            <div class="select-group">
              <label for="firmwareSelect">2Ô∏è‚É£ Ch·ªçn firmware c·∫ßn n·∫°p:</label>
              <select id="firmwareSelect"></select>
            </div>
          </div>

          <img id="schematic" src="" alt="S∆° ƒë·ªì ƒë·∫•u n·ªëi">
          <esp-web-install-button id="flashButton"></esp-web-install-button>
          <div id="log"></div>

          <footer>
            ‚öôÔ∏è H·ªó tr·ª£ Chrome / Edge (PC). Khi nh·∫•n ‚ÄúConnect‚Äù, ch·ªçn ƒë√∫ng c·ªïng COM c·ªßa ESP32-S3.
          </footer>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal ph√≥ng to s∆° ƒë·ªì -->
  <div id="imageModal">
    <img id="modalImage" src="" alt="Ph√≥ng to s∆° ƒë·ªì">
  </div>

  <script>
    // H√†m m·ªü/ƒë√≥ng overlay
    function openOrder(){document.getElementById('orderOverlay').style.display='block';}
    function closeOrder(){document.getElementById('orderOverlay').style.display='none';}

    function openActivate(){document.getElementById('activateOverlay').style.display='block';}
    function closeActivate(){document.getElementById('activateOverlay').style.display='none';}

    function openFlash(){document.getElementById('flashOverlay').style.display='block';}
    function closeFlash(){document.getElementById('flashOverlay').style.display='none';}

    // Form k√≠ch ho·∫°t (demo hi·ªÉn th·ªã)
    document.getElementById('activeForm').addEventListener('submit', function(e){
      e.preventDefault();
      const id = document.getElementById('deviceID').value.trim();
      const code = document.getElementById('activeCode').value.trim();
      const result = document.getElementById('result');
      if(!id || !code){
        result.innerHTML = "<span style='color:#f97316;'>‚ö†Ô∏è Vui l√≤ng nh·∫≠p ƒë·∫ßy ƒë·ªß M√£ thi·∫øt b·ªã v√† M√£ k√≠ch ho·∫°t.</span>";
        return;
      }
      result.innerHTML = "‚úÖ ƒê√£ nh·∫≠n th√¥ng tin k√≠ch ho·∫°t cho thi·∫øt b·ªã <b>" + id + "</b>. (Demo hi·ªÉn th·ªã, c·∫ßn server n·∫øu mu·ªën l∆∞u th·∫≠t)";
    });

    // ESP32 Flash Tool config
    (function () {
      const boardSelect = document.getElementById("boardSelect");
      const firmwareSelect = document.getElementById("firmwareSelect");
      const flashButton = document.getElementById("flashButton");
      const logDiv = document.getElementById("log");
      const schematic = document.getElementById("schematic");
      const imageModal = document.getElementById("imageModal");
      const modalImage = document.getElementById("modalImage");

      const firmwareOptions = {
        esp32s3: [
          { name: "Oled 0.96inch 128x64px SSD1306", file: "esp32_s3_oled_0_96inch_128x64_ssd1306.bin", img: "https://dienthongminhesmart.com/chatbot-xiaozhi/images/esp32_s3_oled_0_96inch_128x64_ssd1306.png" },
          { name: "TFT 1.54inch 240x240px ST7789", file: "esp32_s3_tft_1_54inch_240x240_st7789.bin", img: "https://dienthongminhesmart.com/chatbot-xiaozhi/images/esp32_s3_tft_1_54inch_240x240_st7789.png" },
          { name: "TFT 1.54inch 240x240px ST7789 WeChat", file: "esp32_s3_tft_1_54inch_240x240_st7789_wechat.bin", img: "https://dienthongminhesmart.com/chatbot-xiaozhi/images/esp32_s3_tft_1_54inch_240x240_st7789.png" },
          { name: "TFT 2.4inch 240x320px ST7789", file: "esp32_s3_tft_2_4inch_240x320_st7789.bin", img: "https://dienthongminhesmart.com/chatbot-xiaozhi/images/esp32_s3_tft_2_4inch_240x320_st7789.png" },
          { name: "TFT 2.4inch 240x320px ST7789 WeChat", file: "esp32_s3_tft_2_4inch_240x320_st7789_wechat.bin", img: "https://dienthongminhesmart.com/chatbot-xiaozhi/images/esp32_s3_tft_2_4inch_240x320_st7789.png" },
          { name: "TFT 2.8inch 240x320px ILI9341", file: "esp32_s3_tft_2_8inch_240x320_ili9341.bin", img: "https://dienthongminhesmart.com/chatbot-xiaozhi/images/esp32_s3_tft_2_8inch_240x320_ili9341.png" },
          { name: "TFT 2.8inch 240x320px ILI9341 WeChat", file: "esp32_s3_tft_2_8inch_240x320_ili9341_wechat.bin", img: "https://dienthongminhesmart.com/chatbot-xiaozhi/images/esp32_s3_tft_2_8inch_240x320_ili9341.png" }
        ],
        esp32s3ai: [
          { name: "Oled 0.96inch 128x64px SSD1306", file: "esp32_s3_ai_oled_0_96inch_128x64_ssd1306.bin", img: "https://dienthongminhesmart.com/chatbot-xiaozhi/images/esp32_s3_ai_oled_0_96inch_128x64_ssd1306.png" },
          { name: "TFT 1.54inch 240x240px ST7789", file: "esp32_s3_ai_tft_1_54inch_240x240_st7789.bin", img: "https://dienthongminhesmart.com/chatbot-xiaozhi/images/esp32_s3_ai_tft_1_54inch_240x240_st7789.png" },
          { name: "TFT 1.54inch 240x240px ST7789 Tivi mini", file: "esp32_s3_ai_tft_1_54inch_240x240_st7789_tivi_mini.bin", img: "https://dienthongminhesmart.com/chatbot-xiaozhi/images/esp32_s3_ai_tft_1_54inch_240x240_st7789_tivi_mini.png" }
        ],
        esp32s3cam: [
          { name: "XH-S3E TFT 1.54inch 240x240px ST7789", file: "esp32_s3_cam_xh_s3e_tft_1_54inch_240x240_st7789.bin", img: "https://dienthongminhesmart.com/chatbot-xiaozhi/images/esp32_s3_cam_xh_s3e_tft_1_54inch_240x240_st7789.jpg" },
          { name: "WROOM 1 TFT 1.54inch 240x240px ST7789", file: "esp32_s3_cam_wroom_tft_1_54inch_240x240_st7789.bin", img: "https://dienthongminhesmart.com/chatbot-xiaozhi/images/esp32_s3_cam_wroom_tft_1_54inch_240x240_st7789.jpg" }
        ]
      };

      function log(msg){
        const time = new Date().toLocaleTimeString();
        logDiv.innerHTML += `[${time}] ${msg}<br>`;
        logDiv.scrollTop = logDiv.scrollHeight;
      }

      function updateFirmwareList(){
        const board = boardSelect.value;
        firmwareSelect.innerHTML = "";
        (firmwareOptions[board] || []).forEach(fw=>{
          const opt = document.createElement("option");
          opt.value = fw.file;
          opt.textContent = fw.name;
          opt.dataset.img = fw.img;
          firmwareSelect.appendChild(opt);
        });
        updateManifest();
        updateSchematic();
      }

      function updateSchematic(){
        const selected = firmwareSelect.selectedOptions[0];
        const imgSrc = selected ? selected.dataset.img : "";
        if(imgSrc){
          schematic.src = imgSrc;
          schematic.style.display = "block";
        }else{
          schematic.style.display = "none";
        }
      }

      function updateManifest(){
        const board = boardSelect.value;
        const firmwareFile = firmwareSelect.value;
        if(!firmwareFile) return;

        const firmwareURL = "https://dienthongminhesmart.com/chatbot-xiaozhi/firmwares/" + firmwareFile;

        const manifest = {
          name: "Firmware Xiaozhi",
          builds: [
            {
              chipFamily: "ESP32-S3",
              parts: [
                { offset: 0x0, path: firmwareURL }
              ]
            }
          ]
        };

        const blob = new Blob([JSON.stringify(manifest)], { type: "application/json" });
        const manifestURL = URL.createObjectURL(blob);
        flashButton.setAttribute("manifest", manifestURL);

        log(`üì¶ Ch·ªçn board: ${board} | Firmware: ${firmwareFile}`);
      }

      firmwareSelect.addEventListener("change", () => {
        updateManifest();
        updateSchematic();
      });

      boardSelect.addEventListener("change", updateFirmwareList);

      schematic.addEventListener("click", () => {
        if(!schematic.src) return;
        modalImage.src = schematic.src;
        imageModal.style.display = "flex";
      });

      imageModal.addEventListener("click", () => {
        imageModal.style.display = "none";
      });

      flashButton.addEventListener("web-install-connected", () => log("‚úÖ ƒê√£ k·∫øt n·ªëi v·ªõi thi·∫øt b·ªã."));
      flashButton.addEventListener("web-install-failed", () => log("‚ùå C√≥ l·ªói trong qu√° tr√¨nh n·∫°p."));
      flashButton.addEventListener("web-install-log", (e) => {
        if(e.detail && e.detail.message) log(e.detail.message);
      });

      // Kh·ªüi t·∫°o
      updateFirmwareList();
    })();
  </script>
</body>
</html>
